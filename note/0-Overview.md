## 总览

### 基本概念

- **分布式：**不同模块部署在不同服务器上 
  作用：分布式解决网站高并发带来问题

- **集群：**多台服务器部署相同应用构成一个集群 
  作用：通过负载均衡设备共同对外提供服务

- **微服务：**架构设计概念,各服务间隔离（分布式也是隔离）,自治（分布式依赖整体组合）其它特性(单一职责,边界,异步通信,独立部署)是分布式概念的跟严格执行SOA到微服务架构的演进过程

  作用：各服务可独立应用，组合服务也可系统应用

### SOA

SOA（Service-Oriented Architecture）代表面向服务的架构，俗称服务化。SOA将应用程序的模块化组件通过定义明确的接口和契约联系起来，接口是采用中立的方式进行定义的，独立于某种语音、硬件和操作系统，通常通过网络通信来完成，但是并不局限于某种网络协议，可以是底层的TCP/IP，可以是应用层的HTTP，也可以是消息队列，甚至可以是约定的某种数据库存储形式。这使得各种各样的模块化组件可以以统一和通用的方式交互

SOA具有如下特点：

- SOA 定义了良好的对外接口，通过网络协议对外提供服务，服务之间表现为松祸合性，松祸合性具有灵活的特点，可以对服务流程进行灵活组装和编排，而不需要对服务本身做改变。
-  组成整个业务流程的每个服务的内部结构和实现在发生改变时，不影响整个流程对外提供服务，只要对外的接口保持不变，则改变服务内部的实现机制对外部来说可以是透明的。
-  SOA 在这一时代的数据通信格式通常为XML ，因为XML 标记定义在大规模、高并发通信过程中，元余的标记会给性能带来极大的影响，所以后来被JSON 所取代。
-  SOA 通过定义标准的对外接口，可以让底层通用服务进行下沉，供多个上层的使用方同时使用，增加了服务的可重用性。
- SOA 可以让企业最大化地使用内部和外部的公共服务，避免重复造轮子，例如：通过SOA 从外部获取时间服务。

SOA 的两个主流实现方式： WebService 和ESB 。

WebService：

<div>
    <image src="../res/img/webservice.png"></image>    
</div>

ESB（Enterprise Service Bus 企业服务总线）：

<div>
    <image src="../res/img/ESB.png"></image>
</div>

微服务架构致力于松藕合和高内聚的效果，与SOA 和ESB 相比， 不再强调服务总线和通信机制的多样性，常常通过RESTful 风格的API 和轻量级的消息通信协议来完成。微服务倡导去中心化的治理，不推荐每个微服务都使用相同的标准和技术来开发和使用服务。

### CAP理论

CAP原则是NOSQL数据库的基石。

①**一致性：**对于客户端的每次读操作，要么读到的是最新的数据，要么读取失败。换句话说，一致性是站在分布式系统的角度，对访问本系统的客户端的一种承诺：要么我给您返回一个错误，要么我给你返回绝对一致的最新数据，不难看出，其强调的是数据正确。

②**可用性：**任何客户端的请求都能得到响应数据，不会出现响应错误。换句话说，可用性是站在分布式系统的角度，对访问本系统的客户的另一种承诺：我一定会给您返回数据，不会给你返回错误，但不保证数据最新，强调的是不出错。

③**分区容忍性：**由于分布式系统通过网络进行通信，网络是不可靠的。当任意数量的消息丢失或延迟到达时，系统仍会继续提供服务，不会挂掉。换句话说，分区容忍性是站在分布式系统的角度，对访问本系统的客户端的再一种承诺：我会一直运行，不管我的内部出现何种数据同步问题，强调的是不挂掉。

CAP理论就是说在分布式存储系统中，最多只能实现上面的两点。而由于当前的网络硬件肯定会出现延迟丢包等问题，所以分区容错性是我们必须需要实现的。所以我们只能在一致性和可用性之间进行权衡，**CAP是无法完全兼顾的。**参考：[分布式CAP定理，为什么不能同时满足三个特性？](https://blog.csdn.net/yeyazhishang/article/details/80758354)